<!DOCTYPE html>
<html>
<head>
    <title>Connections Game</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
</head>
<body>
    <h1>Connections Game</h1>
    <div>
        <button id="instructionsButton">Instructions</button>
    </div>
    
    <div id="instructionsModal" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <h2>How to Play Connections</h2>

        <ol>
          <li><strong>Initialize the Game</strong>: Click the "Initialize Game" button to start a new game. This will generate a grid of 16 words.</li>
          <li><strong>Select Words</strong>: Click on the words in the grid to select them. You can select up to 4 words at a time.</li>
          <li><strong>Submit Group</strong>: Once you've selected a group of words, click the "Submit" button to check if they belong to the same category.</li>
          <li><strong>Correct Group</strong>: If the selected words form a correct group, they will fade away and the remaining tiles will form a new, smaller grid.</li>
          <li><strong>Clear Selection</strong>: You can clear your current selection at any time by clicking the "Clear Selection" button.</li>
          <li><strong>Mistakes</strong>: Be careful! You are only allowed up to 4 mistakes. After that, the game will end and reveal the categories and words you didn't find.</li>
          <li><strong>End Game</strong>: The game ends when you've successfully grouped all 16 words or reached the maximum number of mistakes.</li>
          <li><strong>Custom Prompt</strong>: Want to customize the game? Edit the prompt in the text area and click "Initialize Game" again for a new set of categories and words.</li>
        </ol>
        
        <p>This app was created by conversing with ChatGPT and was subsequently enhanced to support cohere.ai API and Gemini Nano.</p>

      </div>
    </div>

    <div id="gemini-info-panel" class="info-panel-hidden">
        <div class="info-panel-content">
            <span id="close-info-panel" class="close-btn">&times;</span>
            <h2>Gemini Nano AI Not Available</h2>
            <p>To use the built-in Gemini AI, please ensure you meet the requirements and have enabled the necessary features in Chrome.</p>
            
            <h3>How to Enable</h3>
            <ol>
                <li>Go to <code>chrome://flags</code> in your address bar.</li>
                <li>Enable the <strong>Prompt API for Gemini Nano</strong> flag (#prompt-api-for-gemini-nano).</li>
                <li>Enable the <strong>Optimization Guide On-Device Model</strong> flag (#optimization-guide-on-device-model).</li>
                <li>Relaunch your browser. The model will download in the background.</li>
            </ol>

            <h3>System Requirements</h3>
            <ul>
                <li><strong>OS:</strong> Windows 10/11, macOS 13+, or Linux</li>
                <li><strong>GPU:</strong> More than 4 GB of VRAM</li>
                <li><strong>Storage:</strong> At least 22 GB of free space for your Chrome profile</li>
            </ul>
            <p><a href="https://developer.chrome.com/docs/ai/prompt-api" target="_blank">Read the Official Documentation</a></p>
        </div>
    </div>

    <label for="apiChoice">Choose AI Provider:</label>
    <select id="apiChoice">
      <option value="">Select an AI Provider</option>
      <option value="openai">OpenAI GPT-4</option>
      <option value="cohere">Cohere</option>
      <option value="gemini-flash">Gemini Flash</option>
      <option value="gemini">Gemini Nano (Local)</option>
    </select>
    
    <div id="apiKeyContainer" style="display: none;">
        <label for="apiKey">Enter API Key:</label>
        <input type="password" id="apiKey">
    </div>
    
    <div>
        <button id="initializeGame">Initialize Game</button>
        <div id="loadingIcon" class="loading-icon-hidden">
          <div class="spinner"></div>
        </div>
    </div>

    <div id="grid">
        </div>
    <button id="submitBtn">Submit</button>
    <button id="clearBtn">Clear</button>
    <div>
        <div id="mistakeCounter">Mistakes: 0</div>
        <div id="foundCategories">Found Categories:</div>
        <div id="statusMessage"></div>
    </div>
    <br>
    <div class="prompt-container">
        <label for="gpt4Prompt">Optionally edit the prompt:</label>
        <div>
            <textarea id="gpt4Prompt" rows="16">
Generate 4 categories of words, each containing exactly 4 unique words.
Ensure that no words are duplicated across categories.
In total, there should be exactly 16 unique words.
Make sure the same word does not appear in more than one category.
Try to include words that could be ambiguous
and fit into more than one category.
For example, the word 'mouse' could be ambiguous if
both 'ANIMALS' and 'COMPUTER PARTS' are categories
but it should be part of only one category.
But don't use the mouse example.
Categories can also be like "FIRE ___" for
Ant, Drill, Island, Opal.
Or something else about the words independent of their meaning.
</textarea>
        </div>
    </div>
    <script src="script.js"></script>
</body>
</html>