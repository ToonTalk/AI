:root{
  --bg:#0f0c1a; --panel:#17132a; --ink:#f5f3ff; --muted:#bfb9ff;
  --good:#3ee06d; --warn:#ffcc4d; --accent:#7c5cff; --accent2:#31d0ff;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif}
header{display:flex;align-items:center;gap:.75rem;padding:14px 18px;background:var(--panel);border-bottom:1px solid #2a2545}
header h1{font-size:18px;margin:0;font-weight:700}
.container{display:grid;grid-template-columns:minmax(520px,1fr) 360px;gap:14px;padding:14px}
.card{background:var(--panel);border:1px solid #2a2545;border-radius:12px;overflow:hidden}
.card h2{margin:0;padding:8px 12px;border-bottom:1px solid #2a2545;font-size:15px;color:var(--muted)}
.playbar{display:flex;gap:8px;align-items:center;flex-wrap:wrap;padding:8px 12px;border-bottom:1px solid #2a2545}
.btn{appearance:none;border:0;background:#fff;color:#1a1240;border-radius:10px;padding:6px 10px;font-weight:700;cursor:pointer}
.btn.ghost{background:transparent;color:var(--ink);border:1px solid #3a3460}
.switch{display:inline-flex;gap:6px;align-items:center;border:1px solid #3a3460;border-radius:999px;padding:3px}
.switch input{display:none}
.switch label{padding:.3rem .6rem;border-radius:999px;cursor:pointer;font-size:.85rem;color:var(--muted)}
.switch input:checked + label{background:linear-gradient(135deg,var(--accent),var(--accent2));color:#0b0620;font-weight:800}
#mazeWrap{position:relative;padding:0 12px 12px 12px}
#mazeCanvas{display:block;background:#0e0b1d;border-radius:10px;}
.legend{padding:8px 12px;display:flex;gap:12px;flex-wrap:wrap;font-size:14px}
.right .section{padding:10px;border-bottom:1px solid #2a2545}
.universes{max-height:48vh;overflow:auto;padding:6px 10px}
.u{display:flex;align-items:center;gap:10px;padding:8px;border-radius:12px;background:#1e1940;border:1px solid #2a2545;margin:6px 0}
.u.active{outline:2px solid var(--accent2)}
.u.flash{outline:2px solid var(--accent2);animation:flash 900ms ease-out 1}
.u.preview{opacity:.9;border-style:dashed}
@keyframes flash{0%{box-shadow:0 0 0 0 rgba(49,208,255,.8);}100%{box-shadow:0 0 0 16px rgba(49,208,255,0);}}
.chip{width:18px;height:18px;border-radius:999px;border:2px solid #fff3}
.meta{font-size:.82rem;color:var(--muted)}
.footer{padding:10px;color:var(--muted);font-size:.9rem}
details{padding:10px}
.kbd{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;background:#ffffff1a;padding:2px 6px;border-radius:6px}
.tests{padding:8px 12px;border-top:1px solid #2a2545;font-size:13px}
.pass{color:#8ef39b} .fail{color:#ff7f7f}
/* Flyers that travel from canvas to list */
.flyer{position:fixed;left:0;top:0;z-index:999;pointer-events:none;will-change:transform,opacity;filter:drop-shadow(0 6px 16px rgba(0,0,0,.45))}
/* Trail pips */
.trail{position:fixed;left:0;top:0;z-index:998;pointer-events:none;will-change:transform,opacity;transition:transform 900ms ease-out, opacity 900ms ease-out;filter:drop-shadow(0 4px 10px rgba(0,0,0,.4))}
.trail-dot{position:fixed;left:0;top:0;z-index:998;pointer-events:none;will-change:transform,opacity;transition:transform 900ms ease-out, opacity 900ms ease-out;border-radius:999px}

/* === Story overlay === */
.storyOverlay{position:fixed;inset:0;z-index:4000;display:grid;place-items:center;padding:20px;background:radial-gradient(1200px 800px at 70% -10%, #221a46ee 0%, #0f0c1abf 60%);backdrop-filter:blur(8px)}
.storyCard{max-width:920px;width:min(92vw,920px);background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));border:1px solid rgba(255,255,255,.12);border-radius:16px;box-shadow:0 20px 60px rgba(0,0,0,.45);padding:18px}
.storyHead{display:flex;align-items:center;gap:12px;margin-bottom:6px}
.storyTitle{margin:0;font-size:clamp(18px,2.8vw,24px)}
.panels{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin:10px 0}
.panel{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.12);border-radius:12px;padding:12px;display:flex;gap:12px}
.panel .emo{font-size:28px;line-height:1}
.panel p{margin:0;color:var(--muted);font-size:14px}
.storyActions{display:flex;gap:10px;justify-content:flex-end;margin-top:10px}
.linkish{color:var(--muted);text-decoration:underline;cursor:pointer}
@media (max-width:800px){ .panels{grid-template-columns:1fr} }

/* Slider value bubble */
.rangeGroup{display:flex;align-items:center;gap:8px}
.bubble{display:inline-block;min-width:2ch;padding:2px 8px;border-radius:999px;background:#ffffffdd;color:#1a1240;font-weight:700;font-size:.85rem;line-height:1.4}