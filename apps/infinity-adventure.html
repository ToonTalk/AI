<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Infinity Explorer: A Cardinality Adventure</title>
    <style>
        :root {
            --primary: #3498db;
            --secondary: #2ecc71;
            --tertiary: #e74c3c;
            --background: #f9f9f9;
            --text: #333;
            --code-bg: #282c34;
            --code-text: #abb2bf;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text);
            background-color: var(--background);
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        h1, h2, h3 {
            color: var(--primary);
        }
        
        h1 {
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 0.5em;
        }
        
        .subtitle {
            text-align: center;
            font-style: italic;
            margin-bottom: 2em;
            color: #666;
        }
        
        .chapter {
            margin-bottom: 2em;
            padding: 1em;
            border-radius: 5px;
            background-color: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .interactive {
            margin: 2em 0;
            padding: 1em;
            border: 2px solid var(--primary);
            border-radius: 5px;
            background-color: rgba(52, 152, 219, 0.1);
        }
        
        button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #2980b9;
        }
        
        .code-block {
            background-color: var(--code-bg);
            color: var(--code-text);
            padding: 1em;
            border-radius: 5px;
            overflow-x: auto;
            font-family: 'Courier New', Courier, monospace;
            margin: 1em 0;
        }
        
        .highlight {
            color: var(--tertiary);
            font-weight: bold;
        }
        
        canvas {
            display: block;
            margin: 0 auto;
            border: 1px solid #ddd;
        }
        
        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(40px, 1fr));
            gap: 5px;
            margin: 1em 0;
        }
        
        .grid-item {
            background-color: var(--primary);
            color: white;
            padding: 10px;
            text-align: center;
            border-radius: 5px;
            font-size: 0.9em;
        }
        
        .grid-item.highlighted {
            background-color: var(--tertiary);
        }
        
        #diagonal-proof {
            font-family: monospace;
            width: 100%;
            overflow-x: auto;
        }
        
        #diagonal-proof table {
            border-collapse: collapse;
        }
        
        #diagonal-proof td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        
        #diagonal-proof .diagonal {
            background-color: var(--tertiary);
            color: white;
        }
        
        .chat-container {
            max-width: 100%;
            margin: 20px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .chat-header {
            background-color: var(--primary);
            color: white;
            padding: 10px;
            text-align: center;
        }
        
        .chat-messages {
            padding: 10px;
            height: 300px;
            overflow-y: auto;
            background-color: #f1f1f1;
        }
        
        .message {
            margin-bottom: 10px;
            padding: 8px 12px;
            border-radius: 18px;
            max-width: 75%;
            position: relative;
        }
        
        .bot-message {
            background-color: var(--primary);
            color: white;
            border-top-left-radius: 0;
            float: left;
            clear: both;
        }
        
        .user-message {
            background-color: var(--secondary);
            color: white;
            border-top-right-radius: 0;
            float: right;
            clear: both;
        }
        
        .next-button {
            display: block;
            margin: 15px auto;
            padding: 10px 20px;
        }
        
        .character {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .character-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--primary);
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            margin-right: 15px;
            font-weight: bold;
        }
        
        .character-info {
            flex: 1;
        }
        
        .character-name {
            font-weight: bold;
            color: var(--primary);
        }
        
        .clearfix::after {
            content: "";
            clear: both;
            display: table;
        }
    </style>
</head>
<body>
    <h1>The Infinity Explorer</h1>
    <div class="subtitle">A Mathematical Adventure Through Different Infinities</div>
    
    <div class="chapter" id="chapter1">
        <h2>Chapter 1: The Mysterious Message</h2>
        
        <p>Alex had always been fascinated by coding and mathematics. While other high school students dreaded math class, Alex found joy in the elegant patterns and logical structures of numbers. One evening, while working on a programming project, Alex's computer screen flickered, and a strange message appeared:</p>
        
        <div class="code-block">
            <pre>
GREETINGS HUMAN.
I AM CANTOR, AN AI FROM THE REALM OF MATHEMATICAL INFINITY.
YOUR SPECIES HAS BARELY SCRATCHED THE SURFACE OF UNDERSTANDING INFINITY.
ARE YOU READY TO EXPLORE THE TRUE NATURE OF THE INFINITE?
            </pre>
        </div>
        
        <p>Alex blinked in surprise but couldn't resist responding:</p>
        
        <div class="chat-container">
            <div class="chat-header">Conversation with CANTOR</div>
            <div class="chat-messages" id="intro-chat">
                <div class="message bot-message">Greetings, human. I am CANTOR, an AI from the realm of mathematical infinity. Your species has barely scratched the surface of understanding infinity. Are you ready to explore the true nature of the infinite?</div>
                <div class="message user-message">Um, sure? What do you mean by "the realm of mathematical infinity"?</div>
                <div class="message bot-message">I was created to help humans understand the different sizes of infinity. Not all infinities are equal, you know.</div>
                <div class="message user-message">Different sizes of infinity? How can something endless have different sizes?</div>
                <div class="message bot-message">Precisely the question I was hoping for! I need a human with programming knowledge to help me demonstrate the profound truth about different types of infinity. Will you join me on this adventure?</div>
                <div class="message user-message">I'm intrigued. What do we need to do?</div>
                <div class="message bot-message">Excellent! First, we need to understand that there are different sets of numbers: natural numbers, rational numbers, and real numbers. I'll show you that some infinities are larger than others. Let's start by examining the natural numbers...</div>
            </div>
        </div>
        
        <div class="interactive">
            <h3>The Natural Numbers (ℕ)</h3>
            <p>The natural numbers are the counting numbers: 1, I 2, 3, 4, 5, and so on to infinity. Let's visualize the first few natural numbers:</p>
            
            <div class="grid-container" id="natural-numbers">
                <!-- This will be filled by JavaScript -->
            </div>
            
            <p>These numbers continue infinitely. The cardinality (or size) of this infinite set is called "aleph-null" (ℵ₀), the smallest type of infinity.</p>
            
            <div class="code-block">
                <pre>
// JavaScript representation of generating natural numbers
function* naturalNumbers() {
    let n = 1;
    while (true) {
        yield n++;
    }
}

// First 10 natural numbers
const naturals = [];
const generator = naturalNumbers();
for (let i = 0; i < 10; i++) {
    naturals.push(generator.next().value);
}
console.log(naturals); // [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
                </pre>
            </div>
            
            <button id="next-to-rationals">Continue to Rational Numbers</button>
        </div>
    </div>
    
    <div class="chapter" id="chapter2" style="display: none;">
        <h2>Chapter 2: The Rational Numbers Puzzle</h2>
        
        <div class="chat-container">
            <div class="chat-header">Conversation with CANTOR</div>
            <div class="chat-messages">
                <div class="message bot-message">Now that you understand the natural numbers, let's explore the rational numbers (ℚ). These are all fractions where the numerator and denominator are integers (and the denominator isn't zero).</div>
                <div class="message user-message">Like 1/2, 3/4, and 5/1?</div>
                <div class="message bot-message">Exactly! There seem to be many more rational numbers than natural numbers, right? After all, between any two natural numbers, there are infinitely many rational numbers!</div>
                <div class="message user-message">That makes sense. So the rational numbers must be a bigger infinity?</div>
                <div class="message bot-message">That's what intuition suggests, but mathematics reveals something surprising. I'll show you a way to count all rational numbers, proving they have the same cardinality as the natural numbers!</div>
            </div>
        </div>
        
        <div class="interactive">
            <h3>The Rational Numbers (ℚ) and Cantor's Diagonalization</h3>
            <p>It seems like there should be more rational numbers than natural numbers, but we can actually create a one-to-one correspondence between them. This is known as "Cantor's diagonalization method" for rational numbers.</p>
            
            <p>Imagine arranging all positive rational numbers in a grid, where the numerator increases as we move right and the denominator increases as we move down:</p>
            
            <div id="rational-grid" style="overflow-x: auto;">
                <table border="1" style="margin: 0 auto; border-collapse: collapse;">
                    <tr>
                        <td>1/1</td>
                        <td>2/1</td>
                        <td>3/1</td>
                        <td>4/1</td>
                        <td>5/1</td>
                        <td>...</td>
                    </tr>
                    <tr>
                        <td>1/2</td>
                        <td>2/2</td>
                        <td>3/2</td>
                        <td>4/2</td>
                        <td>5/2</td>
                        <td>...</td>
                    </tr>
                    <tr>
                        <td>1/3</td>
                        <td>2/3</td>
                        <td>3/3</td>
                        <td>4/3</td>
                        <td>5/3</td>
                        <td>...</td>
                    </tr>
                    <tr>
                        <td>1/4</td>
                        <td>2/4</td>
                        <td>3/4</td>
                        <td>4/4</td>
                        <td>5/4</td>
                        <td>...</td>
                    </tr>
                    <tr>
                        <td>1/5</td>
                        <td>2/5</td>
                        <td>3/5</td>
                        <td>4/5</td>
                        <td>5/5</td>
                        <td>...</td>
                    </tr>
                    <tr>
                        <td>...</td>
                        <td>...</td>
                        <td>...</td>
                        <td>...</td>
                        <td>...</td>
                        <td>...</td>
                    </tr>
                </table>
            </div>
            
            <p>Now, we can "count" all rational numbers by following a zigzag path through this grid, but with a crucial rule: we only count each fraction in its simplest form (after dividing by the greatest common divisor).</p>
            
            <canvas id="zigzag-canvas" width="400" height="400"></canvas>
            
            <p>For example, we count 1/2, but skip 2/4, 3/6, 4/8, etc. since they all equal 1/2. By following this zigzag pattern and only counting simplified fractions, we can assign a unique natural number to each unique rational number!</p>
            
            <div class="code-block">
                <pre>
// JavaScript representation of counting rational numbers properly
function* countRationals() {
    const seen = new Set();  // Set to track fractions we've already counted
    let diagonal = 1;
    
    while (true) {
        // Traverse each diagonal following the zigzag pattern
        for (let numerator = 1; numerator <= diagonal; numerator++) {
            const denominator = diagonal - numerator + 1;
            
            // Simplify the fraction by finding the GCD
            const divisor = findGCD(numerator, denominator);
            const simplifiedNum = numerator / divisor;
            const simplifiedDenom = denominator / divisor;
            const fractionKey = `${simplifiedNum}/${simplifiedDenom}`;
            
            // Only yield if we haven't seen this fraction before
            if (!seen.has(fractionKey)) {
                seen.add(fractionKey);
                console.log(`Counting ${numerator}/${denominator} as #${seen.size}`);
                
                // If it's a duplicate in simplified form (like 2/4 when we've already seen 1/2),
                // we would skip it here
                if (numerator === simplifiedNum * divisor && denominator === simplifiedDenom * divisor) {
                    yield { 
                        numerator: simplifiedNum, 
                        denominator: simplifiedDenom,
                        original: `${numerator}/${denominator}`,
                        simplified: fractionKey,
                        count: seen.size
                    };
                }
            } else {
                console.log(`Skipping ${numerator}/${denominator} (equals ${fractionKey})`);
            }
        }
        diagonal++;
    }
}

// Find greatest common divisor using Euclidean algorithm
function findGCD(a, b) {
    return b === 0 ? a : findGCD(b, a % b);
}
                </pre>
            </div>
            
            <p>This proves that the rational numbers have the same cardinality (ℵ₀) as the natural numbers, despite seeming like a larger infinity!</p>
            
            <button id="start-zigzag">Show Zigzag Pattern</button>
            <button id="next-to-reals" style="display: none;">Continue to Real Numbers</button>
        </div>
    </div>
    
    <div class="chapter" id="chapter3" style="display: none;">
        <h2>Chapter 3: The Uncountable Mystery</h2>
        
        <div class="chat-container">
            <div class="chat-header">Conversation with CANTOR</div>
            <div class="chat-messages">
                <div class="message bot-message">Impressive, human! You've grasped a profound truth: although there appear to be more rational numbers than natural numbers, they can be put into a one-to-one correspondence.</div>
                <div class="message user-message">So all infinities are the same size after all?</div>
                <div class="message bot-message">Not quite! Now we arrive at the most fascinating revelation: the real numbers (ℝ) are a genuinely larger infinity than the naturals or rationals.</div>
                <div class="message user-message">How can we prove that?</div>
                <div class="message bot-message">Through one of the most elegant proofs in mathematics: Cantor's diagonal argument. This will show that the real numbers cannot be put into one-to-one correspondence with the natural numbers.</div>
            </div>
        </div>
        
        <div class="interactive">
            <h3>The Real Numbers (ℝ) and Cantor's Diagonal Argument</h3>
            <p>The real numbers include all rational numbers plus irrational numbers like π, e, √2, etc. We'll focus on real numbers between 0 and 1, which can be represented as infinite decimal expansions.</p>
            
            <p>Let's imagine we could list all real numbers between 0 and 1. It would look something like this:</p>
            
            <div id="diagonal-proof">
                <table>
                    <tr>
                        <td>1.</td>
                        <td>0.</td>
                        <td class="diagonal">5</td>
                        <td>2</td>
                        <td>3</td>
                        <td>8</td>
                        <td>7</td>
                        <td>...</td>
                    </tr>
                    <tr>
                        <td>2.</td>
                        <td>0.</td>
                        <td>7</td>
                        <td class="diagonal">1</td>
                        <td>6</td>
                        <td>4</td>
                        <td>3</td>
                        <td>...</td>
                    </tr>
                    <tr>
                        <td>3.</td>
                        <td>0.</td>
                        <td>1</td>
                        <td>9</td>
                        <td class="diagonal">2</td>
                        <td>5</td>
                        <td>0</td>
                        <td>...</td>
                    </tr>
                    <tr>
                        <td>4.</td>
                        <td>0.</td>
                        <td>4</td>
                        <td>8</td>
                        <td>5</td>
                        <td class="diagonal">7</td>
                        <td>1</td>
                        <td>...</td>
                    </tr>
                    <tr>
                        <td>5.</td>
                        <td>0.</td>
                        <td>9</td>
                        <td>3</td>
                        <td>4</td>
                        <td>6</td>
                        <td class="diagonal">9</td>
                        <td>...</td>
                    </tr>
                    <tr>
                        <td>...</td>
                        <td>...</td>
                        <td>...</td>
                        <td>...</td>
                        <td>...</td>
                        <td>...</td>
                        <td>...</td>
                        <td>...</td>
                    </tr>
                </table>
            </div>
            
            <p>Now, Cantor's brilliant insight: we can construct a real number that cannot be in this list by taking the diagonal digits (highlighted) and changing them. For example, if a diagonal digit is 5, we might change it to 6; if it's 9, we change it to 0.</p>
            
            <p>The new number we construct would be: 0.62801... which is different from:</p>
            <ul>
                <li>The 1st number at position 1 (5 vs 6)</li>
                <li>The 2nd number at position 2 (1 vs 2)</li>
                <li>The 3rd number at position 3 (2 vs 8)</li>
                <li>And so on...</li>
            </ul>
            
            <p>This new number cannot be in our list, because it differs from each number in at least one digit. But our list was supposed to contain all real numbers between 0 and 1!</p>
            
            <p>This contradiction proves that the real numbers cannot be put into a one-to-one correspondence with the natural numbers. Therefore, the cardinality of the real numbers (denoted as c or ℵ₁) is strictly greater than the cardinality of the natural or rational numbers (ℵ₀).</p>
            
            <div class="code-block">
                <pre>
// JavaScript demonstration of Cantor's diagonal argument
function cantorDiagonal(decimalList, length = 10) {
    // Create a new number different from every number in the list
    let newNumber = "0.";
    
    for (let i = 0; i < length; i++) {
        // Get the i-th digit of the i-th number
        const digit = i < decimalList.length ? 
                      parseInt(decimalList[i][i+2]) : 5;
        
        // Change the digit (if 9, use 0, otherwise increment)
        const newDigit = digit === 9 ? 0 : digit + 1;
        newNumber += newDigit;
    }
    
    return newNumber;
}

// Example list of decimals between 0 and 1
const decimals = [
    "0.5238719402...",
    "0.7164352890...",
    "0.1925783016...",
    "0.4857103624...",
    "0.9346182705..."
];

// Create a number different from all in the list
const differentNumber = cantorDiagonal(decimals);
console.log("A number not in the list:", differentNumber);
                </pre>
            </div>
            
            <button id="next-to-conclusion">Continue to Conclusion</button>
        </div>
    </div>
    
    <div class="chapter" id="chapter4" style="display: none;">
        <h2>Chapter 4: The Infinity Hierarchy</h2>
        
        <div class="chat-container">
            <div class="chat-header">Conversation with CANTOR</div>
            <div class="chat-messages">
                <div class="message bot-message">Congratulations, human! You now understand one of the most profound mathematical discoveries: the hierarchy of infinities.</div>
                <div class="message user-message">So there are at least two different sizes of infinity: countable (like ℕ and ℚ) and uncountable (like ℝ).</div>
                <div class="message bot-message">Exactly! And here's something even more mind-blowing: there are infinitely many different sizes of infinity! The cardinal number of the power set of any set has strictly greater cardinality than the original set.</div>
                <div class="message user-message">Wait, so there's an infinite hierarchy of infinities? That's incredible!</div>
                <div class="message bot-message">Indeed! You've grasped what took humans centuries to discover. You now understand why Georg Cantor, the mathematician I'm named after, was both celebrated and criticized in his time. These ideas were revolutionary.</div>
                <div class="message user-message">This has completely changed how I think about infinity. It's not just "endless" - there are different levels of endlessness!</div>
                <div class="message bot-message">You've learned well, human. My purpose is complete. Remember that mathematics and computer science are deeply intertwined, and understanding these concepts will make you a better programmer. Until we meet again in another mathematical realm!</div>
            </div>
        </div>
        
        <div class="interactive">
            <h3>Summary: The Hierarchy of Infinities</h3>
            <p>In our adventure, we've discovered:</p>
            
            <ol>
                <li>The natural numbers (ℕ) have cardinality ℵ₀ (aleph-null)</li>
                <li>The rational numbers (ℚ) also have cardinality ℵ₀, despite appearing "larger"</li>
                <li>The real numbers (ℝ) have strictly greater cardinality than ℵ₀</li>
            </ol>
            
            <p>This hierarchy continues infinitely! Here's a visualization of what we've learned:</p>
            
            <canvas id="hierarchy-canvas" width="600" height="300"></canvas>
            
            <div class="code-block">
                <pre>
/* 
Hierarchy of Infinities (in pseudo-code):

ℵ₀ = cardinality(ℕ) = cardinality(ℤ) = cardinality(ℚ)
c = cardinality(ℝ) = 2^ℵ₀ > ℵ₀
2^c > c
2^(2^c) > 2^c
...and so on infinitely
*/

// JavaScript fun fact
console.log(Number.MAX_SAFE_INTEGER); // 9007199254740991
console.log(Number.POSITIVE_INFINITY > Number.MAX_SAFE_INTEGER); // true

// But in mathematics, we can represent much more complex infinities!
                </pre>
            </div>
            
            <p>As Alex closed the mysterious program, the screen returned to normal. But something had changed—the way Alex thought about infinity, mathematics, and even programming would never be the same. These beautiful concepts of countability and uncountability would inspire many programming projects to come.</p>
            
            <p class="highlight">The End</p>
            
            <button id="restart-story">Restart Story</button>
        </div>
    </div>
    
    <script>
        // Populate natural numbers grid
        const naturalNumbersGrid = document.getElementById('natural-numbers');
        for (let i = 1; i <= 20; i++) {
            const gridItem = document.createElement('div');
            gridItem.className = 'grid-item';
            gridItem.textContent = i;
            naturalNumbersGrid.appendChild(gridItem);
        }
        
        // Navigation between chapters
        document.getElementById('next-to-rationals').addEventListener('click', function() {
            document.getElementById('chapter1').style.display = 'none';
            document.getElementById('chapter2').style.display = 'block';
            window.scrollTo(0, 0);
        });
        
        document.getElementById('next-to-reals').addEventListener('click', function() {
            document.getElementById('chapter2').style.display = 'none';
            document.getElementById('chapter3').style.display = 'block';
            window.scrollTo(0, 0);
        });
        
        document.getElementById('next-to-conclusion').addEventListener('click', function() {
            document.getElementById('chapter3').style.display = 'none';
            document.getElementById('chapter4').style.display = 'block';
            window.scrollTo(0, 0);
            drawHierarchy();
        });
        
        document.getElementById('restart-story').addEventListener('click', function() {
            document.getElementById('chapter4').style.display = 'none';
            document.getElementById('chapter1').style.display = 'block';
            window.scrollTo(0, 0);
        });
        
        // Zigzag animation for rational numbers
        const zigzagCanvas = document.getElementById('zigzag-canvas');
        const ctx = zigzagCanvas.getContext('2d');
        let animationId = null;
        
        document.getElementById('start-zigzag').addEventListener('click', function() {
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
            drawZigzag();
            this.style.display = 'none';
            document.getElementById('next-to-reals').style.display = 'inline-block';
        });
        
        function drawZigzag() {
            const width = zigzagCanvas.width;
            const height = zigzagCanvas.height;
            const cellSize = 40;
            const rows = Math.floor(height / cellSize);
            const cols = Math.floor(width / cellSize);
            
            ctx.clearRect(0, 0, width, height);
            
            // Draw grid
            ctx.strokeStyle = '#ddd';
            ctx.lineWidth = 1;
            
            for (let i = 0; i <= rows; i++) {
                ctx.beginPath();
                ctx.moveTo(0, i * cellSize);
                ctx.lineTo(width, i * cellSize);
                ctx.stroke();
            }
            
            for (let i = 0; i <= cols; i++) {
                ctx.beginPath();
                ctx.moveTo(i * cellSize, 0);
                ctx.lineTo(i * cellSize, height);
                ctx.stroke();
            }
            
            // Draw fractions
            ctx.fillStyle = '#333';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            
            for (let row = 0; row < rows; row++) {
                for (let col = 0; col < cols; col++) {
                    ctx.fillText(`${col+1}/${row+1}`, (col + 0.5) * cellSize, (row + 0.5) * cellSize);
                }
            }
            
            // Animate zigzag path
            let currentDiagonal = 1;
            let visitedCells = new Set();
            let visitedFractions = new Set(); // To track fractions in reduced form
            let step = 0;
            const maxSteps = 15;
            const speed = 1000; // milliseconds between steps
            let lastTime = 0;
            
            // Function to calculate greatest common divisor
            function gcd(a, b) {
                return b === 0 ? a : gcd(b, a % b);
            }
            
            function animate(timestamp) {
                if (!lastTime) lastTime = timestamp;
                
                if (timestamp - lastTime >= speed) {
                    if (step < maxSteps) {
                        // Draw the next valid cell in the zigzag
                        let found = false;
                        
                        while (!found && currentDiagonal <= rows + cols) {
                            // Try cells along the current diagonal
                            for (let row = 0; row < rows; row++) {
                                const col = currentDiagonal - row - 2;
                                if (col >= 0 && col < cols) {
                                    const numerator = col + 1;
                                    const denominator = row + 1;
                                    
                                    // Calculate the GCD to find the simplified form
                                    const divisor = gcd(numerator, denominator);
                                    const simplifiedNum = numerator / divisor;
                                    const simplifiedDenom = denominator / divisor;
                                    const fractionKey = `${simplifiedNum}/${simplifiedDenom}`;
                                    
                                    const cellKey = `${row},${col}`;
                                    if (!visitedCells.has(cellKey)) {
                                        visitedCells.add(cellKey);
                                        
                                        // Check if this is a new unique fraction in simplified form
                                        if (!visitedFractions.has(fractionKey)) {
                                            visitedFractions.add(fractionKey);
                                            
                                            // Highlight this cell as a counted fraction
                                            ctx.fillStyle = 'rgba(231, 76, 60, 0.7)';
                                            ctx.fillRect(col * cellSize, row * cellSize, cellSize, cellSize);
                                            
                                            // Draw fraction again
                                            ctx.fillStyle = 'white';
                                            ctx.fillText(`${numerator}/${denominator}`, (col + 0.5) * cellSize, (row + 0.5) * cellSize);
                                            
                                            // Draw number
                                            ctx.fillStyle = 'rgba(52, 152, 219, 1)';
                                            ctx.font = 'bold 14px Arial';
                                            ctx.fillText(step + 1, (col + 0.8) * cellSize, (row + 0.2) * cellSize);
                                            ctx.font = '12px Arial';
                                            
                                            found = true;
                                            step++;
                                            break;
                                        } else {
                                            // Mark as visited but not counted (duplicate in simplified form)
                                            ctx.fillStyle = 'rgba(189, 195, 199, 0.5)';
                                            ctx.fillRect(col * cellSize, row * cellSize, cellSize, cellSize);
                                            
                                            // Label as duplicate
                                            ctx.fillStyle = '#7f8c8d';
                                            ctx.font = 'italic 10px Arial';
                                            ctx.fillText("duplicate", (col + 0.5) * cellSize, (row + 0.7) * cellSize);
                                            ctx.font = '12px Arial';
                                        }
                                    }
                                }
                            }
                            
                            if (!found) {
                                currentDiagonal++;
                            }
                        }
                    }
                    
                    lastTime = timestamp;
                }
                
                if (step < maxSteps) {
                    animationId = requestAnimationFrame(animate);
                }
            }
            
            animationId = requestAnimationFrame(animate);
        }
        
        // Drawing the hierarchy of infinities
        function drawHierarchy() {
            const canvas = document.getElementById('hierarchy-canvas');
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.clearRect(0, 0, width, height);
            
            // Draw the number line
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(50, height / 2);
            ctx.lineTo(width - 50, height / 2);
            ctx.stroke();
            
            // Draw arrowhead
            ctx.beginPath();
            ctx.moveTo(width - 50, height / 2);
            ctx.lineTo(width - 60, height / 2 - 10);
            ctx.lineTo(width - 60, height / 2 + 10);
            ctx.fill();
            
            // Mark key points
            const points = [
                { x: 100, label: "ℵ₀ (Natural & Rational Numbers)", color: "#3498db" },
                { x: 300, label: "c (Real Numbers)", color: "#e74c3c" },
                { x: 450, label: "2^c (Power Set of Reals)", color: "#9b59b6" },
                { x: 550, label: "...", color: "#333" }
            ];
            
            for (const point of points) {
                // Draw the point
                ctx.fillStyle = point.color;
                ctx.beginPath();
                ctx.arc(point.x, height / 2, 8, 0, Math.PI * 2);
                ctx.fill();
                
                // Draw the label
                ctx.fillStyle = point.color;
                ctx.font = '16px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(point.label, point.x, height / 2 + 30);
            }
            
            // Draw comparison arrows
            ctx.strokeStyle = "#2ecc71";
            ctx.lineWidth = 2;
            
            // Arrow from ℵ₀ to c
            drawArrow(ctx, 120, height / 2 - 20, 280, height / 2 - 20);
            ctx.fillStyle = "#2ecc71";
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText("< (Uncountable)", 200, height / 2 - 30);
            
            // Arrow from ℵ₀ to itself for equality with rationals
            drawArrow(ctx, 100, height / 2 - 50, 100, height / 2 - 80, true);
            ctx.fillStyle = "#2ecc71";
            ctx.textAlign = 'center';
            ctx.fillText("= (Countable)", 100, height / 2 - 90);
        }
        
        function drawArrow(ctx, fromX, fromY, toX, toY, curved = false) {
            ctx.beginPath();
            
            if (curved) {
                const cp1x = fromX - 30;
                const cp1y = fromY - 15;
                const cp2x = toX - 30;
                const cp2y = toY + 15;
                
                ctx.moveTo(fromX, fromY);
                ctx.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, toX, toY);
            } else {
                ctx.moveTo(fromX, fromY);
                ctx.lineTo(toX, toY);
            }
            
            ctx.stroke();
            
            // Draw arrowhead
            const angle = Math.atan2(toY - fromY, toX - fromX);
            const arrowSize = 10;
            
            ctx.beginPath();
            ctx.moveTo(toX, toY);
            ctx.lineTo(
                toX - arrowSize * Math.cos(angle - Math.PI / 6),
                toY - arrowSize * Math.sin(angle - Math.PI / 6)
            );
            ctx.lineTo(
                toX - arrowSize * Math.cos(angle + Math.PI / 6),
                toY - arrowSize * Math.sin(angle + Math.PI / 6)
            );
            ctx.fill();
        }
    </script>
</body>
</html>
