<!DOCTYPE html>
<html>
<head>
  <title>Sisi & Ada's Dream Weaver</title>
  <style>
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #1a1a1a; color: #f0f0f0; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
    #container { max-width: 600px; text-align: center; background-color: #2a2a2a; padding: 30px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
    h1 { color: #9d79d9; }
    #artwork { width: 100%; height: auto; border-radius: 8px; margin-bottom: 20px; border: 2px solid #444; min-height: 300px; background-color: #333; }
    #story { text-align: left; line-height: 1.6; margin-bottom: 20px; padding: 15px; background-color: #333; border-radius: 8px; }
    input[type="text"] { width: calc(100% - 22px); padding: 10px; border-radius: 5px; border: 1px solid #555; background-color: #444; color: #f0f0f0; font-size: 1em; }
    button { background-color: #7e57c2; color: white; padding: 10px 20px; border: none; border-radius: 5px; font-size: 1em; cursor: pointer; margin-top: 15px; transition: background-color 0.3s; }
    button:hover { background-color: #673ab7; }
    #loader { display: none; margin-top: 15px; }
  </style>
</head>
<body>

  <div id="container">
    <h1>Dream Weaver</h1>
    <img id="artwork" src="https://storage.googleapis.com/gemini-prod/images/prototype_start.png" alt="Generated artwork will appear here">
    <div id="story">
      <p>The journey begins. What do you want to see? Type your first thought below...</p>
    </div>
    <input type="text" id="userInput" placeholder="e.g., a bioluminescent forest at midnight">
    <button onclick="generateNextChapter()">Weave the Dream âœ¨</button>
    <div id="loader">Generating...</div>
  </div>

  <script>
    // In a real app, this would be a growing story object.
    let currentStory = "The journey begins.";

    async function generateNextChapter() {
      const userInput = document.getElementById('userInput').value;
      if (!userInput) {
        alert("Please enter a prompt to continue the story!");
        return;
      }
      
      document.getElementById('loader').style.display = 'block';
      document.querySelector('button').disabled = true;

      // This is where the Gemini magic happens!
      // We send the current story and the user's new idea to the Gemini API.
      const prompt = `
        You are a collaborative storyteller and artist.
        The story so far is: "${currentStory}"
        The user wants to add this to the story: "${userInput}"
        Continue the story with 2-3 new, poetic sentences.
        Then, create a prompt for an image that captures the new scene. The style should be a vibrant, dreamlike digital painting.
        Respond ONLY with a JSON object like this: {"new_story_text": "...", "image_prompt": "..."}
      `;

      // --- In a Gemini Canvas, we can call the model directly ---
      // const model = gemini.getGenerativeModel({model: 'gemini-pro'});
      // const result = await model.generateContent(prompt);
      // const response = JSON.parse(result.response.text());
      // For this prototype, I'll mock the response so you can see it work instantly.

      // Mocked AI Response
      const mockResponse = {
        new_story_text: "A bioluminescent forest at midnight came alive. Giant mushrooms pulsed with a soft, blue light, and the air hummed with the gentle flutter of crystal-winged moths.",
        image_prompt: "A stunning digital painting of a bioluminescent forest at midnight. Towering, glowing mushrooms cast a soft blue light on a mossy path. Crystal-winged moths flutter in the air, creating sparkling trails of light. Dreamlike and ethereal."
      };
      
      // Now, let's pretend we have the image prompt and use the Gemini image generation API
      // const imageResult = await gemini.generateImage({prompt: mockResponse.image_prompt});
      // For the prototype, I'll use a placeholder image URL.
      const mockImageUrl = 'https://storage.googleapis.com/gemini-prod/images/bioluminescent_forest.png';


      // Update the page with the new content
      currentStory += " " + mockResponse.new_story_text;
      document.getElementById('story').innerHTML += `<p>${mockResponse.new_story_text}</p>`;
      document.getElementById('artwork').src = mockImageUrl;
      
      document.getElementById('userInput').value = ''; // Clear the input
      document.getElementById('loader').style.display = 'none';
      document.querySelector('button').disabled = false;
    }
  </script>

</body>
</html>